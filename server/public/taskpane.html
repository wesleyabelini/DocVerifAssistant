<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>Cartório</title><script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script><script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script><script src="d073346f417568a7b58b.js"></script><link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/><link href="831eed399c9b745241d3.css" rel="stylesheet"/><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body class="ms-font-m ms-welcome ms-Fabric"><header class="ms-welcome__header ms-bgColor-neutralLighter"><img width="30" height="30" src="assets/logo-filled.png" alt="Cartório" title="Cartório"/><h1 class="ms-font-su">Cartório</h1><div class="keyclass active"><input id="txtKey" placeholder="Chave"/> <button onclick="cadastrarChave()">Cadastrar</button></div><div class="searchgpt"><select id="cmbProcesso"><option value="contrato_imovel">Contrato Imóvel</option></select> <button onclick="Processar()">Processar</button></div><label id="lblResposta"></label></header></body><script>let app_key=localStorage.getItem("app_key"),enum_Instrucao={contrato_imovel:"O documento abaixo é um contrato de locação de imóvel e alguns campos são obrigatórios. Analise o documento e verifique se contém as seguintes informações que são obrigatórias para o locador e locatário:[nome, rg, cpf, endereço, profissão, conta para realizar o pagamento].Descreva as informações faltantes\nDocumento='"};function cadastrarChave(){checkkey()?setActive():$("#txtKey")[0].value=""}function setActive(){$(".keyclass").removeClass("active"),$(".searchgpt").addClass("active")}function Processar(){getWordText()}function getWordText(){Word.run((function(e){let t=e.document.body;return e.load(t,"text"),e.sync().then((async function(){console.log(t.text),$("#lblResposta")[0].innerText=await gpt(enum_Instrucao[$("#cmbProcesso").val()]+t.text+"'","gpt-3.5-turbo")}))}))}async function checkkey(){let e=$("#txtKey")[0].value;return 200===(await axios.post("https://cartoriochatserver.azurewebsites.net/checkkey",{key:e})).status&&(app_key=e,localStorage.setItem("app_key",app_key),!0)}async function gpt(e,t){return(await axios.post("https://cartoriochatserver.azurewebsites.net/gpt",{model:t,message:e,key:app_key})).data}$(document).ready((function(){app_key&&setActive()}))</script></html>